{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n// функции для HTTP-запросов.\n\n\nconst URL = 'https://pixabay.com/api/';\nconst API_KEY = '42552421-44c442bdd9fc0080a82eeb482';\n\nasync function searchImages(query) {\n  const apiUrl = `${URL}?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true`;\n\n  try {\n    const response = await axios.get(apiUrl);\n\n    if (response.status !== 200) {\n      throw new Error(`HTTP error! Status: ${response.status}`);\n    }\n\n    const data = response.data;\n\n      if (!data.hits || data.hits.length === 0) {\n      throw new Error('No images found for the given query.');\n    }\n\n      return data.hits;\n      \n\n  } catch (error) {\n    // Выводим сообщение об ошибке\n    console.error('Error fetching images:', error.message);\n    // Возвращаем пустой массив в случае ошибки, чтобы обработать ее в вызывающем коде\n    return [];\n  }\n}\n\nexport default searchImages;\n","//импорт библиотеки\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst URL = 'https://pixabay.com/api/';\nconst API_KEY = '42552421-44c442bdd9fc0080a82eeb482';\n\nlet currentPage = 1;\nlet currentQuery = '';\n\n// Функция для отображения галереи изображений\nexport const renderGallery = (response) => {\n  const images = response.hits || [];\n  const totalHits = response.totalHits || 0;\n  const galleryContainer = document.getElementById('gallery');\n  const loadMoreBtn = document.getElementById('load-more-btn');\n  const loadingIndicator = document.getElementById('loading-indicator');\n\n// Очищаем контейнер галереи от всех дочерних элементов\n  while (galleryContainer.firstChild) {\n    galleryContainer.removeChild(galleryContainer.firstChild);\n  }\n\n// Если массив изображений пуст, выводим уведомление и прерываем выполнение функции\n   if (images.length === 0) {\n    iziToast.info({\n      title: 'Info',\n      message: 'Sorry, there are no images matching your search query. Please try again!',\n    });\n\n    loadMoreBtn.style.display = 'none';\n    loadingIndicator.style.display = 'none';\n\n    return;\n  }\n\n  \n  // Для каждого изображения создаем карточку и добавляем ее в контейнер галереи\n  images.forEach((image) => {\n    const card = createImageCard(image);\n    galleryContainer.appendChild(card);\n  });\n\n    // Создаем объект SimpleLightbox\n  const lightbox = new SimpleLightbox('.gallery-item', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n   // Обновляем SimpleLightbox для учета новых изображений\n    lightbox.refresh();\n    \n    // Проверяем, достигли ли конца коллекции\n  if (images.length >= totalHits) {\n    loadMoreBtn.style.display = 'none';\n    iziToast.info({\n      title: 'Info',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    loadMoreBtn.style.display = 'block';\n  }\n\n  loadingIndicator.style.display = 'none';\n};\n\n\n\n\n// Функция создания карточки изображения\nconst createImageCard = (image) => {\n  const card = document.createElement('a');\n  card.classList.add('gallery-item');\n  card.href = image.largeImageURL;\n\n  const img = document.createElement('img');\n  img.src = image.webformatURL;\n  img.alt = image.tags;\n\n  const infoContainer = document.createElement('div');\n  infoContainer.classList.add('gallery-item-info');\n\n  const likes = createInfoElement('Likes', image.likes);\n  const views = createInfoElement('Views', image.views);\n  const comments = createInfoElement('Comments', image.comments);\n  const downloads = createInfoElement('Downloads', image.downloads);\n\n    // Добавляем элементы информации в контейнер\n  infoContainer.appendChild(likes);\n  infoContainer.appendChild(views);\n  infoContainer.appendChild(comments);\n  infoContainer.appendChild(downloads);\n\n  card.appendChild(img);\n  card.appendChild(infoContainer);\n\n  return card;\n};\n\n// Создания элемента информации\nconst createInfoElement = (label, value) => {\n  const infoElement = document.createElement('div');\n  infoElement.classList.add('gallery-item-info-element');\n  \n  const labelElement = document.createElement('span');\n  labelElement.textContent = `${label}: `;\n  \n  const valueElement = document.createElement('span');\n  valueElement.textContent = value;\n  \n  infoElement.appendChild(labelElement);\n  infoElement.appendChild(valueElement);\n\n  return infoElement;\n};\n\nconst loadMoreImages = async () => {\n  currentPage++;\n  try {\n    const response = await fetchImages(currentQuery, currentPage);\n\n    if (response) {\n      renderGallery(response); // Передаем в renderGallery объект response\n    }\n  } catch (error) {\n    console.error('Error loading more images:', error);\n  }\n};\n\nconst fetchImages = async (query, page) => {\n  const apiUrl = `${URL}?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=15`;\n\n  try {\n    const response = await fetch(apiUrl);\n\n    if (!response.ok) {\n      throw new Error(`HTTP error! Status: ${response.status}`);\n    }\n\n    const data = await response.json();\n\n    if (data.hits.length === 0) {\n      throw new Error('No images found for the given query.');\n    }\n\n    return data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n};\n\ndocument.getElementById('load-more-btn').addEventListener('click', () => {\n  document.getElementById('loading-indicator').style.display = 'block';\n  document.getElementById('load-more-btn').style.display = 'none';\n\n  loadMoreImages();\n});\n\ndocument.getElementById('search-form').addEventListener('submit', async (event) => {\n  event.preventDefault();\n \n    // Получаем значение из поисковой строки\n  const query = event.target.querySelector('#search-input').value;\n  currentPage = 1;\n  currentQuery = query;\n\n \n   try {\n    const response = await fetchImages(query, currentPage);\n\n    if (response && response.hits.length > 0) {\n      renderGallery(response);\n    } else {\n      // Вывод сообщения, что изображения не найдены\n      console.log(\"No images found for the given query.\");\n      renderGallery({ hits: [], totalHits: 0 });\n    }\n  } catch (error) {\n    // Обработка других ошибок\n    console.error('Error fetching images:', error);\n  }\n});\n\n\n","\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport searchImages from './js/pixabay-api';\nimport { renderGallery } from './js/render-functions';\n\n// Cсылки на элементы формы поиска, ввода и индикатора загрузки.\nconst searchForm = document.getElementById('search-form');\nconst searchInput = document.getElementById('search-input');\nconst loader = document.querySelector('.loader');\n\n// clearGallery очищает контейнер галереи.\nfunction clearGallery() {\n  const galleryContainer = document.getElementById('gallery');\n  galleryContainer.innerHTML = '';\n}\n\n// hideLoader скрывает индикатор загрузки.\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\n// showLoader отображает индикатор загрузки.\nconst showLoader = () => {\n  loader.style.display = 'block';\n};\n\n// Обработчик события для формы поиска\nsearchForm.addEventListener('submit', function (event) {\n  event.preventDefault();\n\n    // Получаем значение из поля ввода и убираем пробелы по краям\n  const query = searchInput.value.trim();\n\n   // Очищаем галерею перед новым поиском\n  clearGallery();\n\n  // Если запрос пустой, выводится предупреждение, и происходит очистка галереи \n  if (query === '') {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search term.',\n    });\n    clearGallery(); // Очистка галереи при вводе пустой строки\n    return;\n  }\n\n  // Иначе, вызывается функция showLoader для отображения индикатора загрузки\n  showLoader();\n  \n\n  // Отправка запроса к API \n  searchImages(query)\n    .then(images => {\n      if (images.length === 0) {\n          // Если изображения не найдены, выводим сообщение об ошибке\n        iziToast.error({\n          title: 'Error',\n          message: 'Sorry, there are no images matching your search query. Please try again.',\n        });\n      } else {\n        renderGallery(images);\n        searchInput.value = '';\n      }\n    })\n    .catch(error => {\n      console.error('Error in search:', error);\n      searchInput.value = '';\n      iziToast.error({\n        title: 'Error',\n        message: 'An error occurred while fetching images. Please try again.',\n      });\n    })\n    .finally(() => {\n      hideLoader(); \n    });\n});\n"],"names":["URL","API_KEY","searchImages","query","apiUrl","response","axios","data","error","currentPage","currentQuery","renderGallery","images","totalHits","galleryContainer","loadMoreBtn","loadingIndicator","iziToast","image","card","createImageCard","SimpleLightbox","img","infoContainer","likes","createInfoElement","views","comments","downloads","label","value","infoElement","labelElement","valueElement","loadMoreImages","fetchImages","page","event","searchForm","searchInput","loader","clearGallery","hideLoader","showLoader"],"mappings":"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"}